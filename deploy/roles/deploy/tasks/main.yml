- name: Clone server repository
  git: repo=git@github.com:guilro/redado-server.git dest=/srv/server version=master accept_hostkey=yes
- name: Copy project repository
  synchronize:
    src: ../../project.git/
    dest: /srv/project
    rsync_opts:
      - "--exclude=.git"
  notify:
    - restart redado api
    - find workers services
    - restart workers
- name: Clone app repository
  git: repo=git@github.com:guilro/redado-app.git dest=/srv/app version=master accept_hostkey=yes
  notify:
    - install app npm modules
    - compile app for production
    - restart redado webapp
